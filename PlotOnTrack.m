close all; clear all

% clear;clc;
pathx= [687,687,687,687,688,688,692,699,710,720,737,751,765,787,802,819,845,863,891,910,930,962,983,1016,1038,1061,1096,1119,1142,1178,1202,1239,1263,1287,1323,1348,1385,1409,1433,1470,1494,1530,1554,1590,1614,1650,1673,1705,1735,1754,1773,1800,1816,1837,1849,1861,1876,1884,1894,1901,1904,1906,1905,1899,1893,1884,1869,1854,1838,1811,1791,1758,1733,1695,1668,1639,1593,1561,1529,1482,1452,1405,1375,1345,1298,1265,1191,1138,1083,1002,950,874,802,758,699,648,618,582,559,530,507,484,470,447,435,422,414,407,403,399,397,396,395,394,393,392,392,392,392,392,392,390,390,389,388,388,387,387,388,390,391,392,397,401,411,418,478.011363636364,569.647727272727,658.420454545455 ];
pathy = [ 1125,1125,1125,1125,1125,1125,1126,1126,1124,1125,1124,1123,1123,1123,1123,1123,1123,1123,1124,1124,1125,1126,1126,1128,1130,1131,1134,1136,1138,1136,1134,1132,1129,1126,1124,1120,1116,1113,1110,1105,1102,1096,1093,1087,1082,1075,1064,1045,1023,1008,991,965,946,916,896,876,843,819,783,757,729,688,662,620,591,563,521,494,468,432,410,379,361,337,324,313,301,296,293,294,301,311,323,334,349,355,367,371,367,361,361,353,353,363,387,417,441,476,497,528,558,581,599,620,635,660,676,697,709,723,729,735,744,751,758,761,763,761,760,760,764,773,782,791,806,817,828,843,853,870,881,891,912,930,958,978,1049.97727272727,1101.52272727273,1124.43181818182 ];
load('SRRTStar1.mat')

F_S=12;
fig = figure;  %
A=imread('track.jpg');%trackhighresolution,tracklowresolution
B=imshow(A);hold on;
% plot(vehx,vehy,'g');
% plot(hzvehx,hzvehy,'--')
% plot(rx,ry,'r');
% legend('vehicle','reference');
% hold off;
% ax = axes('Parent',fig,'FontSize',F_S,'YTick',[],'XTick',[]);
% box(ax,'off');hold(ax,'all');    
%xlabel('Spars-RRT: 3584 nodes in 10000 iterations in 254.16 s, Cost 8.3603','FontSize',F_S);    
%title('\Delta_{drain}=.1, \Delta_{near}=.5')
hold on
R1.Implot2d()
mm=R1.FollowTrajectory(R1.tree_input(:,R1.best_path),R1.tree(:,R1.best_path),R1.time(R1.best_path));
plot(mm.All_States(1,:),mm.All_States(2,:),'b.')
% % % % % % % % % % % % % % % % % % % % % % % % % % %
% hold on
% plot(1*[-3.5; -2.5],1*[-1; -1],'LineWidth',2,'Parent',ax,'Color',[0 0 0],'LineStyle','-')
% plot(1*[-3.5; -3.5],1*[-1; 0],'LineWidth',2,'Parent',ax,'Color',[0 0 0],'LineStyle','-')
% text(-2.700,-1.200, '1 m', 'HorizontalAlignment','right')
% text(-3.750,-.500, '1 m', 'HorizontalAlignment','center')   