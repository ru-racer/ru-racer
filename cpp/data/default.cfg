# ru_racer_cpp key=value config

# Output
output_root=cpp/results
seed=1234

# Integration / model
dt=0.02
rewiring_value=0.05

# Vehicle constants (rarely change)
# These should be set once for a given platform (mass, dimensions, inertia).
vehicle_m=6.8
vehicle_Izz=0.15
vehicle_lf=0.15
vehicle_lr=0.25
vehicle_h=0.02
vehicle_g=9.8

# Tire model (Magic Formula nominal parameters, as in matlab/Bike.m)
tiref_B=10.275
tiref_C=1.56
tiref_D=-0.85
tirer_B=10.275
tirer_C=1.56
tirer_D=-0.79

# Runtime-updatable friction scaling (used as a multiplier on tire D).
# You can update these online via BikeModel::setFrictionScales(front,rear).
friction_mu_scale_f0=1.0
friction_mu_scale_r0=1.0
friction_mu_scale_f_min=0.3
friction_mu_scale_f_max=1.5
friction_mu_scale_r_min=0.3
friction_mu_scale_r_max=1.5

# Optional obstacles / map
# obstacles_csv=cpp/data/obstacles.csv
# map_file=/absolute/path/to/map3.bmp
# map_pgm=cpp/data/map.pgm   # legacy (pgm only)
# map_pixels_per_meter=100
# map_origin_x_px=281.9
# map_origin_y_px=358.1
# map_free_threshold=0
# map_invert=false
#
# If you want to use an affine world->pixel transform (recommended when calibrating to a specific image):
# map_use_affine=true
# map_a11=100
# map_a12=0
# map_a21=0
# map_a22=-100
# map_b1=281.9
# map_b2=358.1
#
# Example: match MATLAB Implot2d() overlay on track.jpg (not the same as MATLAB map3.bmp):
# map_use_affine=true
# map_a11=0
# map_a12=360
# map_a21=390
# map_a22=0
# map_b1=687
# map_b2=1125

# Start state [x y psi vx vy r]
start_x=0.0
start_y=0.01
start_psi=1.57079632679
start_vx=3.0
start_vy=0.0
start_r=0.0

# Goal state [x y psi vx vy r]
goal_x=0.0
goal_y=-0.05
goal_psi=7.85398163397
goal_vx=1.0
goal_vy=0.0
goal_r=0.0

# State bounds (sampling + feasibility)
xmin_x=-2.6
xmin_y=-0.8
xmin_psi=-6.28318530718
xmin_vx=0.5
xmin_vy=-0.5
xmin_r=-5.0

xmax_x=0.3
xmax_y=3.5
xmax_psi=7.85398163397
xmax_vx=3.5
xmax_vy=0.5
xmax_r=5.0

# RRT*
algorithm=spars_rrt
type=o
max_nodes=50000
max_iterations=50000
delta_goal=0.4
max_step=0.2
delta_drain=0.3
goal_sample_rate=0.0
neighbor_gamma=1.0
neighbor_r_max=1.0

# Control bounds
delta_max=0.3490658504
sfx_max=0.1

# NMPC
run_nmpc=true
nmpc_horizon_steps=15
nmpc_max_iters=25
nmpc_step_size=0.5
nmpc_eps_fd=0.001
nmpc_control_hold_steps=10
nmpc_w_pos=1.0
nmpc_w_psi=0.2
nmpc_w_vx=0.2
nmpc_w_u=0.01

# Auto visualization (writes PNGs into the run folder if python3+matplotlib are available)
auto_visualize=true
viz_bg=track.png
viz_bg_transform=track
viz_show_start_goal=true
