# Small car batch test: multiple random goal points in an 8x8 m plane
#
# Runs planner + NMPC repeatedly with random set-point goals, logging:
# - per-goal subfolders: rrt_nodes/path/ref + nmpc_exec (+ optional visuals)
# - batch_summary.csv at the run root

mode=batch_setpoints
output_root=cpp/results
seed=1234

# Batch controls
batch_count=20
# 8x8 square centered at origin: x,y in [-4,4]
batch_goal_xmin=-4.0
batch_goal_xmax=4.0
batch_goal_ymin=-4.0
batch_goal_ymax=4.0
batch_goal_min_dist=0.8
batch_goal_vx=3.0
batch_goal_psi=0.0
# If true, generates PNGs for every goal (slower). Keep false for large N.
batch_per_goal_visualize=false

# Small car dynamics (MATLAB Bike.m defaults)
dt=0.02
rewiring_value=0.05
vehicle_m=6.8
vehicle_Izz=0.15
vehicle_lf=0.15
vehicle_lr=0.25
vehicle_h=0.02
vehicle_g=9.8
tiref_B=10.275
tiref_C=1.56
tiref_D=-0.85
tirer_B=10.275
tirer_C=1.56
tirer_D=-0.79

# Open space (no map_file, no obstacles_csv)

# Start state [x y psi vx vy r]
start_x=0.0
start_y=0.0
start_psi=0.0
start_vx=3.0
start_vy=0.0
start_r=0.0

# Sampling bounds (cover the 8x8 region + slack)
xmin_x=-5.0
xmin_y=-5.0
xmin_psi=-6.28318530718
xmin_vx=0.5
xmin_vy=-0.5
xmin_r=-5.0
xmax_x=5.0
xmax_y=5.0
xmax_psi=6.28318530718
xmax_vx=5.0
xmax_vy=0.5
xmax_r=5.0

# Planner
algorithm=spars_rrt_star
type=o
max_nodes=50000
max_iterations=50000
delta_goal=0.4
max_step=0.2
delta_drain=0.3
goal_sample_rate=0.05
neighbor_gamma=1.0
neighbor_r_max=1.0
delta_max=0.3490658504
sfx_max=0.1

# NMPC
run_nmpc=true
nmpc_horizon_steps=15
nmpc_max_iters=25
nmpc_step_size=0.5
nmpc_eps_fd=0.001
nmpc_control_hold_steps=10
nmpc_w_pos=1.0
nmpc_w_psi=0.2
nmpc_w_vx=0.2
nmpc_w_u=0.01

# Auto-visualization (only used when batch_per_goal_visualize=true)
auto_visualize=true
viz_bg=
viz_bg_transform=none
viz_show_start_goal=true

